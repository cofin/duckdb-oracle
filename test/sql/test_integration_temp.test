# name: test/sql/test_integration_temp.test
# description: Integration test
# group: [sql]

statement ok
LOAD 'build/release/extension/oracle/oracle.duckdb_extension';

statement ok
SELECT oracle_attach_wallet('/container-entrypoint-initdb.d');

# Verify connection and basic query
query I
SELECT * FROM oracle_query('duckdb_test/duckdb_test@//localhost:11521/FREEPDB1', 'SELECT 1 FROM DUAL');
----
1

# Verify Scan
query IIII
SELECT id, val_varchar, val_number, val_date FROM oracle_scan('duckdb_test/duckdb_test@//localhost:11521/FREEPDB1', 'DUCKDB_TEST', 'TEST_TYPES');
----
1	test	123.45	2025-11-22 00:00:00	2025-11-22 00:00:00

# Verify Vector (as string)
query I
SELECT val_vector FROM oracle_scan('duckdb_test/duckdb_test@//localhost:11521/FREEPDB1', 'DUCKDB_TEST', 'TEST_TYPES');
----
[1.1,2.2,3.3]

