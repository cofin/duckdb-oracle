# name: test/sql/oracle_secret_errors.test
# description: Test Oracle secret error handling and validation
# group: [oracle]

require oracle

# Test 1: Missing required parameter USER
statement error
CREATE SECRET (
    TYPE oracle,
    HOST 'localhost',
    PORT 1521,
    SERVICE 'XEPDB1',
    PASSWORD 'test_pass'
);
----
Oracle secret requires USER parameter

# Test 2: Missing required parameter PASSWORD
statement error
CREATE SECRET (
    TYPE oracle,
    HOST 'localhost',
    PORT 1521,
    SERVICE 'XEPDB1',
    USER 'test_user'
);
----
Oracle secret requires PASSWORD parameter

# Test 3: Missing required parameter SERVICE/DATABASE
statement error
CREATE SECRET (
    TYPE oracle,
    HOST 'localhost',
    PORT 1521,
    USER 'test_user',
    PASSWORD 'test_pass'
);
----
Oracle secret requires SERVICE or DATABASE parameter

# Test 4: Invalid port number (too high)
statement error
CREATE SECRET (
    TYPE oracle,
    HOST 'localhost',
    PORT 99999,
    SERVICE 'XEPDB1',
    USER 'test_user',
    PASSWORD 'test_pass'
);
----
PORT must be between 1 and 65535

# Test 5: Invalid port number (zero)
statement error
CREATE SECRET (
    TYPE oracle,
    HOST 'localhost',
    PORT 0,
    SERVICE 'XEPDB1',
    USER 'test_user',
    PASSWORD 'test_pass'
);
----
PORT must be between 1 and 65535

# Test 6: Invalid port number (negative)
statement error
CREATE SECRET (
    TYPE oracle,
    HOST 'localhost',
    PORT -1,
    SERVICE 'XEPDB1',
    USER 'test_user',
    PASSWORD 'test_pass'
);
----
PORT must be between 1 and 65535
