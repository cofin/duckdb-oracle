workflow_name: "Intelligent Feature Development"
version: "2.0"
adaptive: true

phases:
  - name: "context_analysis"
    duration: "auto"  # Scales with project complexity
    agent: "prd"
    steps:
      - name: "load_project_context"
        description: "Read AGENTS.md, existing guides, codebase patterns"
        outputs:
          - "Context understanding document"

      - name: "identify_similar_features"
        description: "Find similar implementations to learn from"
        tools: ["grep", "find", "read"]
        outputs:
          - "Pattern analysis"

      - name: "assess_complexity"
        description: "Determine feature complexity level"
        criteria:
          - "Lines of code impacted"
          - "Number of components affected"
          - "Integration points"
          - "Database schema changes"
        outputs:
          - "Complexity: simple|medium|complex"

      - name: "adapt_workflow"
        description: "Adjust checkpoint count based on complexity"
        adaptive_rules:
          simple: "6 checkpoints"
          medium: "9 checkpoints"
          complex: "12+ checkpoints"

  - name: "planning"
    agent: "prd"
    gemini_command: "/prd {feature-description}"
    adaptive_checkpoints: true  # Count adjusts based on complexity
    quality_gates:
      - "context_loaded"
      - "research_complete"
      - "patterns_identified"

  - name: "implementation"
    agent: "expert"
    auto_trigger: false  # User must explicitly run
    adaptive: true
    quality_gates:
      - "local_tests_pass"
      - "linting_clean"
      - "follows_project_patterns"

  - name: "knowledge_capture"
    agent: "docs-vision"
    auto_trigger: true
    description: "Extract and document new patterns"
    outputs:
      - "specs/guides/patterns/{pattern-name}.md"
      - "specs/guides/examples/{example-name}.py"
      - "Updated AGENTS.md"
